'use strict';

/**
 * Media Upload
 */
window.mediaUploader = {};
(function (window, app) {

	app.init = function () {
		app.cache();
		app.chooseImage();
		app.deleteImage();
	};

	app.cache = function () {
		app.$c = {
			uploadButton: document.getElementById('upload-button'),
			removeButton: document.getElementById('remove-button'),
			attachmentMediaView: document.getElementById('attachment-media-view'),
			browserPreview: document.getElementById('browser-preview'),
			appIconPreview: document.getElementById('app-icon-preview'),
			siteIcon: document.getElementById('site_icon')
		};
	};

	app.chooseImage = function () {
		var mediaUploader;

		app.$c.uploadButton.addEventListener('click', function (e) {

			var mediaUploader = wp.media.frames.file_frame = wp.media({
				title: 'Choose Image',
				button: {
					text: 'Select'
				},
				library: {
					type: 'image'
				},
				multiple: false
			});

			e.preventDefault();

			if (mediaUploader) {
				mediaUploader.open();
				return;
			}

			// When a file is selected, grab the URL and set it as the text field's value
			mediaUploader.on('select', function () {
				var attachment = mediaUploader.state().get('selection').first().toJSON();
				app.$c.siteIcon.value = attachment.id;
				app.$c.attachmentMediaView.classList.remove('no-show-preview');
				app.$c.browserPreview.setAttribute('src', attachment.url);
				app.$c.appIconPreview.setAttribute('src', attachment.url);
				app.$c.uploadButton.textContent = 'Change Image';
			});

			// Open the uploader dialog
			mediaUploader.open();
		});
	};

	app.deleteImage = function () {
		app.$c.removeButton.addEventListener('click', function () {
			var answer = confirm('Are you sure?');
			if (answer == true) {
				app.$c.siteIcon.value = '0';
				app.$c.attachmentMediaView.classList.add('no-show-preview');
				app.$c.uploadButton.textContent = 'Select Image';
			}
			return false;
		});
	};

	app.init();
})(window, window.mediaUploader);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lZGlhLXVwbG9hZC5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJtZWRpYVVwbG9hZGVyIiwiYXBwIiwiaW5pdCIsImNhY2hlIiwiY2hvb3NlSW1hZ2UiLCJkZWxldGVJbWFnZSIsIiRjIiwidXBsb2FkQnV0dG9uIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInJlbW92ZUJ1dHRvbiIsImF0dGFjaG1lbnRNZWRpYVZpZXciLCJicm93c2VyUHJldmlldyIsImFwcEljb25QcmV2aWV3Iiwic2l0ZUljb24iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsIndwIiwibWVkaWEiLCJmcmFtZXMiLCJmaWxlX2ZyYW1lIiwidGl0bGUiLCJidXR0b24iLCJ0ZXh0IiwibGlicmFyeSIsInR5cGUiLCJtdWx0aXBsZSIsInByZXZlbnREZWZhdWx0Iiwib3BlbiIsIm9uIiwiYXR0YWNobWVudCIsInN0YXRlIiwiZ2V0IiwiZmlyc3QiLCJ0b0pTT04iLCJ2YWx1ZSIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic2V0QXR0cmlidXRlIiwidXJsIiwidGV4dENvbnRlbnQiLCJhbnN3ZXIiLCJjb25maXJtIiwiYWRkIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7QUFHQUEsT0FBT0MsYUFBUCxHQUF1QixFQUF2QjtBQUNFLFdBQVVELE1BQVYsRUFBa0JFLEdBQWxCLEVBQXdCOztBQUV6QkEsS0FBSUMsSUFBSixHQUFXLFlBQVc7QUFDckJELE1BQUlFLEtBQUo7QUFDQUYsTUFBSUcsV0FBSjtBQUNBSCxNQUFJSSxXQUFKO0FBQ0EsRUFKRDs7QUFNQUosS0FBSUUsS0FBSixHQUFZLFlBQVc7QUFDdEJGLE1BQUlLLEVBQUosR0FBUztBQUNSQyxpQkFBY0MsU0FBU0MsY0FBVCxDQUF5QixlQUF6QixDQUROO0FBRVJDLGlCQUFjRixTQUFTQyxjQUFULENBQXlCLGVBQXpCLENBRk47QUFHUkUsd0JBQXFCSCxTQUFTQyxjQUFULENBQXlCLHVCQUF6QixDQUhiO0FBSVJHLG1CQUFnQkosU0FBU0MsY0FBVCxDQUF5QixpQkFBekIsQ0FKUjtBQUtSSSxtQkFBZ0JMLFNBQVNDLGNBQVQsQ0FBeUIsa0JBQXpCLENBTFI7QUFNUkssYUFBVU4sU0FBU0MsY0FBVCxDQUF5QixXQUF6QjtBQU5GLEdBQVQ7QUFRQSxFQVREOztBQVdBUixLQUFJRyxXQUFKLEdBQWtCLFlBQVc7QUFDNUIsTUFBSUosYUFBSjs7QUFFQUMsTUFBSUssRUFBSixDQUFPQyxZQUFQLENBQW9CUSxnQkFBcEIsQ0FBc0MsT0FBdEMsRUFBK0MsVUFBVUMsQ0FBVixFQUFjOztBQUU1RCxPQUFJaEIsZ0JBQWdCaUIsR0FBR0MsS0FBSCxDQUFTQyxNQUFULENBQWdCQyxVQUFoQixHQUE2QkgsR0FBR0MsS0FBSCxDQUFTO0FBQ3pERyxXQUFPLGNBRGtEO0FBRXpEQyxZQUFRO0FBQ1BDLFdBQU07QUFEQyxLQUZpRDtBQUt6REMsYUFBUztBQUNSQyxXQUFNO0FBREUsS0FMZ0Q7QUFRekRDLGNBQVU7QUFSK0MsSUFBVCxDQUFqRDs7QUFXQVYsS0FBRVcsY0FBRjs7QUFFQSxPQUFLM0IsYUFBTCxFQUFxQjtBQUNwQkEsa0JBQWM0QixJQUFkO0FBQ0E7QUFDQTs7QUFFRDtBQUNBNUIsaUJBQWM2QixFQUFkLENBQWtCLFFBQWxCLEVBQTRCLFlBQVc7QUFDdEMsUUFBSUMsYUFBYTlCLGNBQWMrQixLQUFkLEdBQXNCQyxHQUF0QixDQUEyQixXQUEzQixFQUF5Q0MsS0FBekMsR0FBaURDLE1BQWpELEVBQWpCO0FBQ0FqQyxRQUFJSyxFQUFKLENBQU9RLFFBQVAsQ0FBZ0JxQixLQUFoQixHQUF3QkwsV0FBV00sRUFBbkM7QUFDQW5DLFFBQUlLLEVBQUosQ0FBT0ssbUJBQVAsQ0FBMkIwQixTQUEzQixDQUFxQ0MsTUFBckMsQ0FBNkMsaUJBQTdDO0FBQ0FyQyxRQUFJSyxFQUFKLENBQU9NLGNBQVAsQ0FBc0IyQixZQUF0QixDQUFvQyxLQUFwQyxFQUEyQ1QsV0FBV1UsR0FBdEQ7QUFDQXZDLFFBQUlLLEVBQUosQ0FBT08sY0FBUCxDQUFzQjBCLFlBQXRCLENBQW9DLEtBQXBDLEVBQTJDVCxXQUFXVSxHQUF0RDtBQUNBdkMsUUFBSUssRUFBSixDQUFPQyxZQUFQLENBQW9Ca0MsV0FBcEIsR0FBa0MsY0FBbEM7QUFDQSxJQVBEOztBQVNBO0FBQ0F6QyxpQkFBYzRCLElBQWQ7QUFDQSxHQWhDRDtBQWlDQSxFQXBDRDs7QUFzQ0EzQixLQUFJSSxXQUFKLEdBQWtCLFlBQVc7QUFDNUJKLE1BQUlLLEVBQUosQ0FBT0ksWUFBUCxDQUFvQkssZ0JBQXBCLENBQXNDLE9BQXRDLEVBQStDLFlBQVc7QUFDekQsT0FBSTJCLFNBQVNDLFFBQVMsZUFBVCxDQUFiO0FBQ0EsT0FBS0QsVUFBVSxJQUFmLEVBQXNCO0FBQ3JCekMsUUFBSUssRUFBSixDQUFPUSxRQUFQLENBQWdCcUIsS0FBaEIsR0FBd0IsR0FBeEI7QUFDQWxDLFFBQUlLLEVBQUosQ0FBT0ssbUJBQVAsQ0FBMkIwQixTQUEzQixDQUFxQ08sR0FBckMsQ0FBMEMsaUJBQTFDO0FBQ0EzQyxRQUFJSyxFQUFKLENBQU9DLFlBQVAsQ0FBb0JrQyxXQUFwQixHQUFrQyxjQUFsQztBQUNBO0FBQ0QsVUFBTyxLQUFQO0FBQ0EsR0FSRDtBQVNBLEVBVkQ7O0FBWUF4QyxLQUFJQyxJQUFKO0FBQ0EsQ0F0RUMsRUFzRUNILE1BdEVELEVBc0VTQSxPQUFPQyxhQXRFaEIsQ0FBRiIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTWVkaWEgVXBsb2FkXG4gKi9cbndpbmRvdy5tZWRpYVVwbG9hZGVyID0ge307XG4oIGZ1bmN0aW9uKCB3aW5kb3csIGFwcCApIHtcblxuXHRhcHAuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGFwcC5jYWNoZSgpO1xuXHRcdGFwcC5jaG9vc2VJbWFnZSgpO1xuXHRcdGFwcC5kZWxldGVJbWFnZSgpO1xuXHR9O1xuXG5cdGFwcC5jYWNoZSA9IGZ1bmN0aW9uKCkge1xuXHRcdGFwcC4kYyA9IHtcblx0XHRcdHVwbG9hZEJ1dHRvbjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICd1cGxvYWQtYnV0dG9uJyApLFxuXHRcdFx0cmVtb3ZlQnV0dG9uOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ3JlbW92ZS1idXR0b24nICksXG5cdFx0XHRhdHRhY2htZW50TWVkaWFWaWV3OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ2F0dGFjaG1lbnQtbWVkaWEtdmlldycgKSxcblx0XHRcdGJyb3dzZXJQcmV2aWV3OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ2Jyb3dzZXItcHJldmlldycgKSxcblx0XHRcdGFwcEljb25QcmV2aWV3OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ2FwcC1pY29uLXByZXZpZXcnICksXG5cdFx0XHRzaXRlSWNvbjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICdzaXRlX2ljb24nICksXG5cdFx0fTtcblx0fTtcblxuXHRhcHAuY2hvb3NlSW1hZ2UgPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgbWVkaWFVcGxvYWRlcjtcblxuXHRcdGFwcC4kYy51cGxvYWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cblx0XHRcdHZhciBtZWRpYVVwbG9hZGVyID0gd3AubWVkaWEuZnJhbWVzLmZpbGVfZnJhbWUgPSB3cC5tZWRpYSh7XG5cdFx0XHRcdHRpdGxlOiAnQ2hvb3NlIEltYWdlJyxcblx0XHRcdFx0YnV0dG9uOiB7XG5cdFx0XHRcdFx0dGV4dDogJ1NlbGVjdCcsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGxpYnJhcnk6IHtcblx0XHRcdFx0XHR0eXBlOiAnaW1hZ2UnLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRtdWx0aXBsZTogZmFsc2UsXG5cdFx0XHR9KTtcblxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRpZiAoIG1lZGlhVXBsb2FkZXIgKSB7XG5cdFx0XHRcdG1lZGlhVXBsb2FkZXIub3BlbigpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIFdoZW4gYSBmaWxlIGlzIHNlbGVjdGVkLCBncmFiIHRoZSBVUkwgYW5kIHNldCBpdCBhcyB0aGUgdGV4dCBmaWVsZCdzIHZhbHVlXG5cdFx0XHRtZWRpYVVwbG9hZGVyLm9uKCAnc2VsZWN0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBhdHRhY2htZW50ID0gbWVkaWFVcGxvYWRlci5zdGF0ZSgpLmdldCggJ3NlbGVjdGlvbicgKS5maXJzdCgpLnRvSlNPTigpO1xuXHRcdFx0XHRhcHAuJGMuc2l0ZUljb24udmFsdWUgPSBhdHRhY2htZW50LmlkO1xuXHRcdFx0XHRhcHAuJGMuYXR0YWNobWVudE1lZGlhVmlldy5jbGFzc0xpc3QucmVtb3ZlKCAnbm8tc2hvdy1wcmV2aWV3JyApO1xuXHRcdFx0XHRhcHAuJGMuYnJvd3NlclByZXZpZXcuc2V0QXR0cmlidXRlKCAnc3JjJywgYXR0YWNobWVudC51cmwgKTtcblx0XHRcdFx0YXBwLiRjLmFwcEljb25QcmV2aWV3LnNldEF0dHJpYnV0ZSggJ3NyYycsIGF0dGFjaG1lbnQudXJsICk7XG5cdFx0XHRcdGFwcC4kYy51cGxvYWRCdXR0b24udGV4dENvbnRlbnQgPSAnQ2hhbmdlIEltYWdlJztcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBPcGVuIHRoZSB1cGxvYWRlciBkaWFsb2dcblx0XHRcdG1lZGlhVXBsb2FkZXIub3BlbigpO1xuXHRcdH0pO1xuXHR9O1xuXG5cdGFwcC5kZWxldGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xuXHRcdGFwcC4kYy5yZW1vdmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgYW5zd2VyID0gY29uZmlybSggJ0FyZSB5b3Ugc3VyZT8nICk7XG5cdFx0XHRpZiAoIGFuc3dlciA9PSB0cnVlICkge1xuXHRcdFx0XHRhcHAuJGMuc2l0ZUljb24udmFsdWUgPSAnMCc7XG5cdFx0XHRcdGFwcC4kYy5hdHRhY2htZW50TWVkaWFWaWV3LmNsYXNzTGlzdC5hZGQoICduby1zaG93LXByZXZpZXcnICk7XG5cdFx0XHRcdGFwcC4kYy51cGxvYWRCdXR0b24udGV4dENvbnRlbnQgPSAnU2VsZWN0IEltYWdlJztcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9KTtcblx0fTtcblxuXHRhcHAuaW5pdCgpO1xufSggd2luZG93LCB3aW5kb3cubWVkaWFVcGxvYWRlciApICk7XG4iXX0=

'use strict';

/**
 * Media Upload
 */
window.mediaUploader = {};
(function (window, app) {

	app.init = function () {
		app.cache();
		app.chooseImage();
		app.deleteImage();
	};

	app.cache = function () {
		app.$c = {
			uploadButton: document.getElementById('upload-button'),
			removeButton: document.getElementById('remove-button'),
			attachmentMediaView: document.getElementById('attachment-media-view'),
			browserPreview: document.getElementById('browser-preview'),
			appIconPreview: document.getElementById('app-icon-preview'),
			siteIcon: document.getElementById('site_icon')
		};
	};

	app.chooseImage = function () {
		var mediaUploader;

		app.$c.uploadButton.addEventListener('click', function (e) {
			e.preventDefault();

			if (mediaUploader) {
				mediaUploader.open();
				return;
			}

			var mediaUploader = wp.media.frames.file_frame = wp.media({
				title: 'Choose Image',
				button: {
					text: 'Select'
				},
				library: {
					type: 'image'
				},
				multiple: false
			});

			// When a file is selected, grab the URL and set it as the text field's value
			mediaUploader.on('select', function () {
				var attachment = mediaUploader.state().get('selection').first().toJSON();
				app.$c.siteIcon.value = attachment.id;
				app.$c.attachmentMediaView.classList.remove('no-show-preview');
				app.$c.browserPreview.setAttribute('src', attachment.url);
				app.$c.appIconPreview.setAttribute('src', attachment.url);
				app.$c.uploadButton.textContent = 'Change Image';
			});
			// Open the uploader dialog
			mediaUploader.open();
		});
	};

	app.deleteImage = function () {
		app.$c.removeButton.addEventListener('click', function () {
			var answer = confirm('Are you sure?');
			if (answer == true) {
				app.$c.siteIcon.value = '0';
				app.$c.attachmentMediaView.classList.add('no-show-preview');
				app.$c.uploadButton.textContent = 'Select Image';
			}
			return false;
		});
	};

	app.init();
})(window, window.mediaUploader);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lZGlhLXVwbG9hZC5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJtZWRpYVVwbG9hZGVyIiwiYXBwIiwiaW5pdCIsImNhY2hlIiwiY2hvb3NlSW1hZ2UiLCJkZWxldGVJbWFnZSIsIiRjIiwidXBsb2FkQnV0dG9uIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInJlbW92ZUJ1dHRvbiIsImF0dGFjaG1lbnRNZWRpYVZpZXciLCJicm93c2VyUHJldmlldyIsImFwcEljb25QcmV2aWV3Iiwic2l0ZUljb24iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0Iiwib3BlbiIsIndwIiwibWVkaWEiLCJmcmFtZXMiLCJmaWxlX2ZyYW1lIiwidGl0bGUiLCJidXR0b24iLCJ0ZXh0IiwibGlicmFyeSIsInR5cGUiLCJtdWx0aXBsZSIsIm9uIiwiYXR0YWNobWVudCIsInN0YXRlIiwiZ2V0IiwiZmlyc3QiLCJ0b0pTT04iLCJ2YWx1ZSIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic2V0QXR0cmlidXRlIiwidXJsIiwidGV4dENvbnRlbnQiLCJhbnN3ZXIiLCJjb25maXJtIiwiYWRkIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7QUFHQUEsT0FBT0MsYUFBUCxHQUF1QixFQUF2QjtBQUNBLENBQUUsVUFBVUQsTUFBVixFQUFrQkUsR0FBbEIsRUFBd0I7O0FBRXpCQSxLQUFJQyxJQUFKLEdBQVcsWUFBVztBQUNyQkQsTUFBSUUsS0FBSjtBQUNBRixNQUFJRyxXQUFKO0FBQ0FILE1BQUlJLFdBQUo7QUFDQSxFQUpEOztBQU1BSixLQUFJRSxLQUFKLEdBQVksWUFBVztBQUN0QkYsTUFBSUssRUFBSixHQUFTO0FBQ1JDLGlCQUFlQyxTQUFTQyxjQUFULENBQXdCLGVBQXhCLENBRFA7QUFFUkMsaUJBQWVGLFNBQVNDLGNBQVQsQ0FBd0IsZUFBeEIsQ0FGUDtBQUdSRSx3QkFBc0JILFNBQVNDLGNBQVQsQ0FBd0IsdUJBQXhCLENBSGQ7QUFJUkcsbUJBQWtCSixTQUFTQyxjQUFULENBQXdCLGlCQUF4QixDQUpWO0FBS1JJLG1CQUFpQkwsU0FBU0MsY0FBVCxDQUF3QixrQkFBeEIsQ0FMVDtBQU1SSyxhQUFXTixTQUFTQyxjQUFULENBQXdCLFdBQXhCO0FBTkgsR0FBVDtBQVFBLEVBVEQ7O0FBV0FSLEtBQUlHLFdBQUosR0FBa0IsWUFBVztBQUM1QixNQUFJSixhQUFKOztBQUVBQyxNQUFJSyxFQUFKLENBQU9DLFlBQVAsQ0FBb0JRLGdCQUFwQixDQUFxQyxPQUFyQyxFQUE4QyxVQUFTQyxDQUFULEVBQVk7QUFDekRBLEtBQUVDLGNBQUY7O0FBRUEsT0FBSWpCLGFBQUosRUFBbUI7QUFDbEJBLGtCQUFja0IsSUFBZDtBQUNBO0FBQ0E7O0FBRUQsT0FBSWxCLGdCQUFnQm1CLEdBQUdDLEtBQUgsQ0FBU0MsTUFBVCxDQUFnQkMsVUFBaEIsR0FBNkJILEdBQUdDLEtBQUgsQ0FBUztBQUN6REcsV0FBTyxjQURrRDtBQUV6REMsWUFBUTtBQUNQQyxXQUFNO0FBREMsS0FGaUQ7QUFLekRDLGFBQVM7QUFDUkMsV0FBTTtBQURFLEtBTGdEO0FBUXpEQyxjQUFVO0FBUitDLElBQVQsQ0FBakQ7O0FBWUE7QUFDQTVCLGlCQUFjNkIsRUFBZCxDQUFpQixRQUFqQixFQUEyQixZQUFXO0FBQ3BDLFFBQUlDLGFBQWE5QixjQUFjK0IsS0FBZCxHQUFzQkMsR0FBdEIsQ0FBMEIsV0FBMUIsRUFBdUNDLEtBQXZDLEdBQStDQyxNQUEvQyxFQUFqQjtBQUNBakMsUUFBSUssRUFBSixDQUFPUSxRQUFQLENBQWdCcUIsS0FBaEIsR0FBd0JMLFdBQVdNLEVBQW5DO0FBQ0FuQyxRQUFJSyxFQUFKLENBQU9LLG1CQUFQLENBQTJCMEIsU0FBM0IsQ0FBcUNDLE1BQXJDLENBQTRDLGlCQUE1QztBQUNBckMsUUFBSUssRUFBSixDQUFPTSxjQUFQLENBQXNCMkIsWUFBdEIsQ0FBbUMsS0FBbkMsRUFBMENULFdBQVdVLEdBQXJEO0FBQ0F2QyxRQUFJSyxFQUFKLENBQU9PLGNBQVAsQ0FBc0IwQixZQUF0QixDQUFtQyxLQUFuQyxFQUEwQ1QsV0FBV1UsR0FBckQ7QUFDQXZDLFFBQUlLLEVBQUosQ0FBT0MsWUFBUCxDQUFvQmtDLFdBQXBCLEdBQWtDLGNBQWxDO0FBQ0QsSUFQRDtBQVFBO0FBQ0F6QyxpQkFBY2tCLElBQWQ7QUFDQSxHQS9CRDtBQWdDQSxFQW5DRDs7QUFxQ0FqQixLQUFJSSxXQUFKLEdBQWtCLFlBQVc7QUFDNUJKLE1BQUlLLEVBQUosQ0FBT0ksWUFBUCxDQUFvQkssZ0JBQXBCLENBQXFDLE9BQXJDLEVBQThDLFlBQVc7QUFDeEQsT0FBSTJCLFNBQVNDLFFBQVEsZUFBUixDQUFiO0FBQ0EsT0FBSUQsVUFBVSxJQUFkLEVBQW9CO0FBQ25CekMsUUFBSUssRUFBSixDQUFPUSxRQUFQLENBQWdCcUIsS0FBaEIsR0FBd0IsR0FBeEI7QUFDQWxDLFFBQUlLLEVBQUosQ0FBT0ssbUJBQVAsQ0FBMkIwQixTQUEzQixDQUFxQ08sR0FBckMsQ0FBeUMsaUJBQXpDO0FBQ0EzQyxRQUFJSyxFQUFKLENBQU9DLFlBQVAsQ0FBb0JrQyxXQUFwQixHQUFrQyxjQUFsQztBQUNBO0FBQ0QsVUFBTyxLQUFQO0FBQ0EsR0FSRDtBQVNBLEVBVkQ7O0FBWUF4QyxLQUFJQyxJQUFKO0FBR0EsQ0F2RUQsRUF1RUlILE1BdkVKLEVBdUVZQSxPQUFPQyxhQXZFbkIiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1lZGlhIFVwbG9hZFxuICovXG53aW5kb3cubWVkaWFVcGxvYWRlciA9IHt9O1xuKCBmdW5jdGlvbiggd2luZG93LCBhcHAgKSB7XG5cdFxuXHRhcHAuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGFwcC5jYWNoZSgpO1xuXHRcdGFwcC5jaG9vc2VJbWFnZSgpO1xuXHRcdGFwcC5kZWxldGVJbWFnZSgpO1xuXHR9O1xuXHRcblx0YXBwLmNhY2hlID0gZnVuY3Rpb24oKSB7XG5cdFx0YXBwLiRjID0ge1xuXHRcdFx0dXBsb2FkQnV0dG9uIDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VwbG9hZC1idXR0b24nKSxcblx0XHRcdHJlbW92ZUJ1dHRvbiA6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1vdmUtYnV0dG9uJyksXG5cdFx0XHRhdHRhY2htZW50TWVkaWFWaWV3IDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F0dGFjaG1lbnQtbWVkaWEtdmlldycpLFxuXHRcdFx0YnJvd3NlclByZXZpZXcgIDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jyb3dzZXItcHJldmlldycpLFxuXHRcdFx0YXBwSWNvblByZXZpZXcgOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwLWljb24tcHJldmlldycpLFxuXHRcdFx0c2l0ZUljb24gOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2l0ZV9pY29uJylcblx0XHR9O1xuXHR9O1xuXHRcblx0YXBwLmNob29zZUltYWdlID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG1lZGlhVXBsb2FkZXI7XG5cdFx0XG5cdFx0YXBwLiRjLnVwbG9hZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFxuXHRcdFx0aWYgKG1lZGlhVXBsb2FkZXIpIHtcblx0XHRcdFx0bWVkaWFVcGxvYWRlci5vcGVuKCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dmFyIG1lZGlhVXBsb2FkZXIgPSB3cC5tZWRpYS5mcmFtZXMuZmlsZV9mcmFtZSA9IHdwLm1lZGlhKHtcblx0XHRcdFx0dGl0bGU6ICdDaG9vc2UgSW1hZ2UnLFxuXHRcdFx0XHRidXR0b246IHtcblx0XHRcdFx0XHR0ZXh0OiAnU2VsZWN0J1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRsaWJyYXJ5OiB7XG5cdFx0XHRcdFx0dHlwZTogJ2ltYWdlJ1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRtdWx0aXBsZTogZmFsc2Vcblx0XHRcdH0pO1xuXHRcdFx0XG5cblx0XHRcdC8vIFdoZW4gYSBmaWxlIGlzIHNlbGVjdGVkLCBncmFiIHRoZSBVUkwgYW5kIHNldCBpdCBhcyB0aGUgdGV4dCBmaWVsZCdzIHZhbHVlXG5cdFx0XHRtZWRpYVVwbG9hZGVyLm9uKCdzZWxlY3QnLCBmdW5jdGlvbigpIHtcblx0XHRcdCAgdmFyIGF0dGFjaG1lbnQgPSBtZWRpYVVwbG9hZGVyLnN0YXRlKCkuZ2V0KCdzZWxlY3Rpb24nKS5maXJzdCgpLnRvSlNPTigpO1xuXHRcdFx0ICBhcHAuJGMuc2l0ZUljb24udmFsdWUgPSBhdHRhY2htZW50LmlkO1xuXHRcdFx0ICBhcHAuJGMuYXR0YWNobWVudE1lZGlhVmlldy5jbGFzc0xpc3QucmVtb3ZlKCduby1zaG93LXByZXZpZXcnKTtcblx0XHRcdCAgYXBwLiRjLmJyb3dzZXJQcmV2aWV3LnNldEF0dHJpYnV0ZSgnc3JjJywgYXR0YWNobWVudC51cmwpO1xuXHRcdFx0ICBhcHAuJGMuYXBwSWNvblByZXZpZXcuc2V0QXR0cmlidXRlKCdzcmMnLCBhdHRhY2htZW50LnVybCk7XG5cdFx0XHQgIGFwcC4kYy51cGxvYWRCdXR0b24udGV4dENvbnRlbnQgPSAnQ2hhbmdlIEltYWdlJztcblx0XHRcdH0pO1xuXHRcdFx0Ly8gT3BlbiB0aGUgdXBsb2FkZXIgZGlhbG9nXG5cdFx0XHRtZWRpYVVwbG9hZGVyLm9wZW4oKTtcblx0XHR9KTtcblx0fTtcblx0XG5cdGFwcC5kZWxldGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xuXHRcdGFwcC4kYy5yZW1vdmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBhbnN3ZXIgPSBjb25maXJtKCdBcmUgeW91IHN1cmU/Jyk7XG5cdFx0XHRpZiAoYW5zd2VyID09IHRydWUpIHtcblx0XHRcdFx0YXBwLiRjLnNpdGVJY29uLnZhbHVlID0gJzAnO1xuXHRcdFx0XHRhcHAuJGMuYXR0YWNobWVudE1lZGlhVmlldy5jbGFzc0xpc3QuYWRkKCduby1zaG93LXByZXZpZXcnKTtcblx0XHRcdFx0YXBwLiRjLnVwbG9hZEJ1dHRvbi50ZXh0Q29udGVudCA9ICdTZWxlY3QgSW1hZ2UnO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH0pXG5cdH07XG5cdFxuXHRhcHAuaW5pdCgpO1xuXHRcblx0XG59KSggd2luZG93LCB3aW5kb3cubWVkaWFVcGxvYWRlciApO1xuIl19

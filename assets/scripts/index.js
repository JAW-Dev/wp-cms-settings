'use strict';

/**
 * Media Upload
 */
window.mediaUploader = {};
(function (window, app) {

	app.init = function () {
		app.cache();
		app.chooseImage();
		app.deleteImage();
	};

	app.cache = function () {
		app.$c = {
			uploadButton: document.getElementById('upload-button'),
			removeButton: document.getElementById('remove-button'),
			attachmentMediaView: document.getElementById('attachment-media-view'),
			browserPreview: document.getElementById('browser-preview'),
			appIconPreview: document.getElementById('app-icon-preview'),
			siteIcon: document.getElementById('site_icon')
		};
	};

	app.chooseImage = function () {
		var mediaUploader;

		app.$c.uploadButton.addEventListener('click', function (e) {

			e.preventDefault();

			if (mediaUploader) {
				mediaUploader.open();
				return;
			}

			mediaUploader = wp.media({
				title: 'Choose Image',
				button: {
					text: 'Select'
				},
				library: {
					type: 'image'
				},
				multiple: false
			});

			// When a file is selected, grab the URL and set it as the text field's value
			mediaUploader.on('select', function () {
				var attachment = mediaUploader.state().get('selection').first().toJSON();
				app.$c.siteIcon.value = attachment.id;
				app.$c.attachmentMediaView.classList.remove('no-show-preview');
				app.$c.browserPreview.setAttribute('src', attachment.url);
				app.$c.appIconPreview.setAttribute('src', attachment.url);
				app.$c.uploadButton.textContent = 'Change Image';
			});

			// Open the uploader dialog
			mediaUploader.open();
		});
	};

	app.deleteImage = function () {
		app.$c.removeButton.addEventListener('click', function () {
			var answer = confirm('Are you sure?');
			if (answer == true) {
				app.$c.siteIcon.value = '0';
				app.$c.attachmentMediaView.classList.add('no-show-preview');
				app.$c.uploadButton.textContent = 'Select Image';
			}
			return false;
		});
	};

	app.init();
})(window, window.mediaUploader);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lZGlhLXVwbG9hZC5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJtZWRpYVVwbG9hZGVyIiwiYXBwIiwiaW5pdCIsImNhY2hlIiwiY2hvb3NlSW1hZ2UiLCJkZWxldGVJbWFnZSIsIiRjIiwidXBsb2FkQnV0dG9uIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInJlbW92ZUJ1dHRvbiIsImF0dGFjaG1lbnRNZWRpYVZpZXciLCJicm93c2VyUHJldmlldyIsImFwcEljb25QcmV2aWV3Iiwic2l0ZUljb24iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0Iiwib3BlbiIsIndwIiwibWVkaWEiLCJ0aXRsZSIsImJ1dHRvbiIsInRleHQiLCJsaWJyYXJ5IiwidHlwZSIsIm11bHRpcGxlIiwib24iLCJhdHRhY2htZW50Iiwic3RhdGUiLCJnZXQiLCJmaXJzdCIsInRvSlNPTiIsInZhbHVlIiwiaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzZXRBdHRyaWJ1dGUiLCJ1cmwiLCJ0ZXh0Q29udGVudCIsImFuc3dlciIsImNvbmZpcm0iLCJhZGQiXSwibWFwcGluZ3MiOiI7O0FBQUE7OztBQUdBQSxPQUFPQyxhQUFQLEdBQXVCLEVBQXZCO0FBQ0UsV0FBVUQsTUFBVixFQUFrQkUsR0FBbEIsRUFBd0I7O0FBRXpCQSxLQUFJQyxJQUFKLEdBQVcsWUFBVztBQUNyQkQsTUFBSUUsS0FBSjtBQUNBRixNQUFJRyxXQUFKO0FBQ0FILE1BQUlJLFdBQUo7QUFDQSxFQUpEOztBQU1BSixLQUFJRSxLQUFKLEdBQVksWUFBVztBQUN0QkYsTUFBSUssRUFBSixHQUFTO0FBQ1JDLGlCQUFjQyxTQUFTQyxjQUFULENBQXlCLGVBQXpCLENBRE47QUFFUkMsaUJBQWNGLFNBQVNDLGNBQVQsQ0FBeUIsZUFBekIsQ0FGTjtBQUdSRSx3QkFBcUJILFNBQVNDLGNBQVQsQ0FBeUIsdUJBQXpCLENBSGI7QUFJUkcsbUJBQWdCSixTQUFTQyxjQUFULENBQXlCLGlCQUF6QixDQUpSO0FBS1JJLG1CQUFnQkwsU0FBU0MsY0FBVCxDQUF5QixrQkFBekIsQ0FMUjtBQU1SSyxhQUFVTixTQUFTQyxjQUFULENBQXlCLFdBQXpCO0FBTkYsR0FBVDtBQVFBLEVBVEQ7O0FBV0FSLEtBQUlHLFdBQUosR0FBa0IsWUFBVztBQUM1QixNQUFJSixhQUFKOztBQUVBQyxNQUFJSyxFQUFKLENBQU9DLFlBQVAsQ0FBb0JRLGdCQUFwQixDQUFzQyxPQUF0QyxFQUErQyxVQUFVQyxDQUFWLEVBQWM7O0FBRTVEQSxLQUFFQyxjQUFGOztBQUVBLE9BQUtqQixhQUFMLEVBQXFCO0FBQ3BCQSxrQkFBY2tCLElBQWQ7QUFDQTtBQUNBOztBQUVEbEIsbUJBQWdCbUIsR0FBR0MsS0FBSCxDQUFTO0FBQ3hCQyxXQUFPLGNBRGlCO0FBRXhCQyxZQUFRO0FBQ1BDLFdBQU07QUFEQyxLQUZnQjtBQUt4QkMsYUFBUztBQUNSQyxXQUFNO0FBREUsS0FMZTtBQVF4QkMsY0FBVTtBQVJjLElBQVQsQ0FBaEI7O0FBV0E7QUFDQTFCLGlCQUFjMkIsRUFBZCxDQUFrQixRQUFsQixFQUE0QixZQUFXO0FBQ3RDLFFBQUlDLGFBQWE1QixjQUFjNkIsS0FBZCxHQUFzQkMsR0FBdEIsQ0FBMkIsV0FBM0IsRUFBeUNDLEtBQXpDLEdBQWlEQyxNQUFqRCxFQUFqQjtBQUNBL0IsUUFBSUssRUFBSixDQUFPUSxRQUFQLENBQWdCbUIsS0FBaEIsR0FBd0JMLFdBQVdNLEVBQW5DO0FBQ0FqQyxRQUFJSyxFQUFKLENBQU9LLG1CQUFQLENBQTJCd0IsU0FBM0IsQ0FBcUNDLE1BQXJDLENBQTZDLGlCQUE3QztBQUNBbkMsUUFBSUssRUFBSixDQUFPTSxjQUFQLENBQXNCeUIsWUFBdEIsQ0FBb0MsS0FBcEMsRUFBMkNULFdBQVdVLEdBQXREO0FBQ0FyQyxRQUFJSyxFQUFKLENBQU9PLGNBQVAsQ0FBc0J3QixZQUF0QixDQUFvQyxLQUFwQyxFQUEyQ1QsV0FBV1UsR0FBdEQ7QUFDQXJDLFFBQUlLLEVBQUosQ0FBT0MsWUFBUCxDQUFvQmdDLFdBQXBCLEdBQWtDLGNBQWxDO0FBQ0EsSUFQRDs7QUFTQTtBQUNBdkMsaUJBQWNrQixJQUFkO0FBQ0EsR0FoQ0Q7QUFpQ0EsRUFwQ0Q7O0FBc0NBakIsS0FBSUksV0FBSixHQUFrQixZQUFXO0FBQzVCSixNQUFJSyxFQUFKLENBQU9JLFlBQVAsQ0FBb0JLLGdCQUFwQixDQUFzQyxPQUF0QyxFQUErQyxZQUFXO0FBQ3pELE9BQUl5QixTQUFTQyxRQUFTLGVBQVQsQ0FBYjtBQUNBLE9BQUtELFVBQVUsSUFBZixFQUFzQjtBQUNyQnZDLFFBQUlLLEVBQUosQ0FBT1EsUUFBUCxDQUFnQm1CLEtBQWhCLEdBQXdCLEdBQXhCO0FBQ0FoQyxRQUFJSyxFQUFKLENBQU9LLG1CQUFQLENBQTJCd0IsU0FBM0IsQ0FBcUNPLEdBQXJDLENBQTBDLGlCQUExQztBQUNBekMsUUFBSUssRUFBSixDQUFPQyxZQUFQLENBQW9CZ0MsV0FBcEIsR0FBa0MsY0FBbEM7QUFDQTtBQUNELFVBQU8sS0FBUDtBQUNBLEdBUkQ7QUFTQSxFQVZEOztBQVlBdEMsS0FBSUMsSUFBSjtBQUNBLENBdEVDLEVBc0VDSCxNQXRFRCxFQXNFU0EsT0FBT0MsYUF0RWhCLENBQUYiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1lZGlhIFVwbG9hZFxuICovXG53aW5kb3cubWVkaWFVcGxvYWRlciA9IHt9O1xuKCBmdW5jdGlvbiggd2luZG93LCBhcHAgKSB7XG5cblx0YXBwLmluaXQgPSBmdW5jdGlvbigpIHtcblx0XHRhcHAuY2FjaGUoKTtcblx0XHRhcHAuY2hvb3NlSW1hZ2UoKTtcblx0XHRhcHAuZGVsZXRlSW1hZ2UoKTtcblx0fTtcblxuXHRhcHAuY2FjaGUgPSBmdW5jdGlvbigpIHtcblx0XHRhcHAuJGMgPSB7XG5cdFx0XHR1cGxvYWRCdXR0b246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAndXBsb2FkLWJ1dHRvbicgKSxcblx0XHRcdHJlbW92ZUJ1dHRvbjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICdyZW1vdmUtYnV0dG9uJyApLFxuXHRcdFx0YXR0YWNobWVudE1lZGlhVmlldzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICdhdHRhY2htZW50LW1lZGlhLXZpZXcnICksXG5cdFx0XHRicm93c2VyUHJldmlldzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICdicm93c2VyLXByZXZpZXcnICksXG5cdFx0XHRhcHBJY29uUHJldmlldzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICdhcHAtaWNvbi1wcmV2aWV3JyApLFxuXHRcdFx0c2l0ZUljb246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAnc2l0ZV9pY29uJyApLFxuXHRcdH07XG5cdH07XG5cblx0YXBwLmNob29zZUltYWdlID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG1lZGlhVXBsb2FkZXI7XG5cblx0XHRhcHAuJGMudXBsb2FkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdGlmICggbWVkaWFVcGxvYWRlciApIHtcblx0XHRcdFx0bWVkaWFVcGxvYWRlci5vcGVuKCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0bWVkaWFVcGxvYWRlciA9IHdwLm1lZGlhKHtcblx0XHRcdFx0dGl0bGU6ICdDaG9vc2UgSW1hZ2UnLFxuXHRcdFx0XHRidXR0b246IHtcblx0XHRcdFx0XHR0ZXh0OiAnU2VsZWN0Jyxcblx0XHRcdFx0fSxcblx0XHRcdFx0bGlicmFyeToge1xuXHRcdFx0XHRcdHR5cGU6ICdpbWFnZScsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdG11bHRpcGxlOiBmYWxzZSxcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBXaGVuIGEgZmlsZSBpcyBzZWxlY3RlZCwgZ3JhYiB0aGUgVVJMIGFuZCBzZXQgaXQgYXMgdGhlIHRleHQgZmllbGQncyB2YWx1ZVxuXHRcdFx0bWVkaWFVcGxvYWRlci5vbiggJ3NlbGVjdCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgYXR0YWNobWVudCA9IG1lZGlhVXBsb2FkZXIuc3RhdGUoKS5nZXQoICdzZWxlY3Rpb24nICkuZmlyc3QoKS50b0pTT04oKTtcblx0XHRcdFx0YXBwLiRjLnNpdGVJY29uLnZhbHVlID0gYXR0YWNobWVudC5pZDtcblx0XHRcdFx0YXBwLiRjLmF0dGFjaG1lbnRNZWRpYVZpZXcuY2xhc3NMaXN0LnJlbW92ZSggJ25vLXNob3ctcHJldmlldycgKTtcblx0XHRcdFx0YXBwLiRjLmJyb3dzZXJQcmV2aWV3LnNldEF0dHJpYnV0ZSggJ3NyYycsIGF0dGFjaG1lbnQudXJsICk7XG5cdFx0XHRcdGFwcC4kYy5hcHBJY29uUHJldmlldy5zZXRBdHRyaWJ1dGUoICdzcmMnLCBhdHRhY2htZW50LnVybCApO1xuXHRcdFx0XHRhcHAuJGMudXBsb2FkQnV0dG9uLnRleHRDb250ZW50ID0gJ0NoYW5nZSBJbWFnZSc7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gT3BlbiB0aGUgdXBsb2FkZXIgZGlhbG9nXG5cdFx0XHRtZWRpYVVwbG9hZGVyLm9wZW4oKTtcblx0XHR9KTtcblx0fTtcblxuXHRhcHAuZGVsZXRlSW1hZ2UgPSBmdW5jdGlvbigpIHtcblx0XHRhcHAuJGMucmVtb3ZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGFuc3dlciA9IGNvbmZpcm0oICdBcmUgeW91IHN1cmU/JyApO1xuXHRcdFx0aWYgKCBhbnN3ZXIgPT0gdHJ1ZSApIHtcblx0XHRcdFx0YXBwLiRjLnNpdGVJY29uLnZhbHVlID0gJzAnO1xuXHRcdFx0XHRhcHAuJGMuYXR0YWNobWVudE1lZGlhVmlldy5jbGFzc0xpc3QuYWRkKCAnbm8tc2hvdy1wcmV2aWV3JyApO1xuXHRcdFx0XHRhcHAuJGMudXBsb2FkQnV0dG9uLnRleHRDb250ZW50ID0gJ1NlbGVjdCBJbWFnZSc7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fSk7XG5cdH07XG5cblx0YXBwLmluaXQoKTtcbn0oIHdpbmRvdywgd2luZG93Lm1lZGlhVXBsb2FkZXIgKSApO1xuIl19
